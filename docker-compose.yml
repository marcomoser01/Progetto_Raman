version: '3'
services:
  mysql:
    image: mysql:latest
    environment:
      MYSQL_ROOT_PASSWORD: Root
    ports:
      - 3306:3306
    networks:
      - my_network

  zipkin:
    image: openzipkin/zipkin
    ports:
      - 9411:9411
    networks:
      - my_network

  config-server:
    build:
      context: ./config-server
      dockerfile: Dockerfile
    depends_on:
      - mysql
    ports:
      - 8888:8888
    networks:
      - my_network

  registry:
    build:
      context: ./registry
      dockerfile: Dockerfile
    depends_on:
      - mysql
    ports:
      - 8761:8761
    networks:
      - my_network

  catalog:
    build:
      context: ./catalog
      dockerfile: Dockerfile
    depends_on:
      - config-server
      - zipkin
    ports:
      - 8080:8080
    networks:
      - my_network
    links:
      - config-server
    restart: on-failure

networks:
  my_network:
